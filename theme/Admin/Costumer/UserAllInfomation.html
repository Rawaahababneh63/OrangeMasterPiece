<!DOCTYPE html>
<html>
  <head>
    <!-- Basic Page Info -->
    <meta charset="utf-8" />
    <title>DeskApp - Bootstrap Admin Dashboard HTML Template</title>

    <!-- Site favicon -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="../vendors/images/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../vendors/images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../vendors/images/favicon-16x16.png"
    />

    <!-- Mobile Specific Metas -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="../vendors/styles/core.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="../vendors/styles/icon-font.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="../src/plugins/datatables/css/dataTables.bootstrap4.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="../src/plugins/datatables/css/responsive.bootstrap4.min.css"
    />
    <link rel="stylesheet" type="text/css" href="../vendors/styles/style.css" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-GBZ3SGGX85"
    ></script>
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2973766580778258"
      crossorigin="anonymous"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-GBZ3SGGX85");
    </script>
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-NXZMQSS");
    </script>
    <!-- End Google Tag Manager -->
  </head>
  <style>
    body {
    margin-top: 7%;
    padding: 0;
    font-family: 'Inter', sans-serif;
    font-weight: 400;
    min-height: 100%;
    color: #031e23;
    background: #ecf0f4;
    overflow-y: hidden;
}
    .section {
            display: none;
        }
        .section.active {
    display: block;
    margin-top: 10%;
}
</style>

<body>
	<div class="header">
		<div class="header-left">
			<div class="menu-icon bi bi-list"></div>
			<div class="search-toggle-icon bi bi-search" data-toggle="header_search"></div>
		
		</div>
		<div class="header-right">
			<div class="dashboard-setting user-notification">
				<div class="dropdown">
					<a class="dropdown-toggle no-arrow" href="javascript:;" data-toggle="right-sidebar">
					
					</a>
				</div>
			</div>
	
			<div class="user-info-dropdown">
				<div class="dropdown">
					<a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
						
						<span class="user-name">Rawa'ah Ababneh</span>
					</a>
					<div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
					
						<a class="dropdown-item" onclick="logout()"><i class="dw dw-logout"></i> Log Out</a>
					</div>
				</div>
			</div>

		</div>
	</div>
	<div class="left-side-bar">
		<div class="brand-logo">
			<a href="../index1.html">
				<img src="../vendors/images/Smart1.png" alt="" class="dark-logo" />
				<img src="../vendors/images/Smart.png"  class="light-logo" />
			</a>
			
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div>
		<div class="menu-block customscroll">
			<div class="sidebar-menu">
				<ul id="accordion-menu">
					<li class="dropdown">
						<a href="../index1.html" class="dropdown-toggle  no-arrow">
							<span class="micon bi bi-house"></span><span class="mtext">Home</span>
						</a>
					</li>
						
				
					
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon bi bi-file-earmark-text"></span><span class="mtext">Category
								</span>
						</a>
						<ul class="submenu">
							<li><a href="../Category/AllCategory.html">ALL Category</a></li>
						
							
							
						</ul>
					</li>

					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon bi bi-file-earmark-text"></span><span class="mtext">SubCategory
								</span>
						</a>
						<ul class="submenu">
							<li><a href="../SubCategory/SubCategory.html">SubCategory By CategoryId</a></li>
							<li><a href="../SubCategory/AllSubCategory.html">ALL SubCategory</a></li>
						
							
							
						</ul>
					</li>

                    <li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon bi bi-file-earmark-text"></span><span class="mtext">Product
								</span>
						</a>
						<ul class="submenu">
							<li><a href="../Product/allProduct.html">ALLproduct</a></li>
							<li><a href="../Product/addProduct.html">Add product</a></li>
							<li><a href="../Product/applayDisount.html">Applay Discount</a></li>
						</ul>

					</li>

                    <li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
							<span class="micon bi bi-file-earmark-text"></span><span class="mtext">News
								</span>
						</a>
						<ul class="submenu">
							<li><a href="../News/News.html">News</a></li>
							<li><a href="../News/UpdateNews.html"> UpdateNews</a></li>
							
						</ul>

					</li>

					<li>
						<a href="javascript:;" class="dropdown-toggle">
						  <span class="micon bi bi-file-earmark-text"></span
						  ><span class="mtext">Review </span>
						</a>
						<ul class="submenu">
						  <li><a href="../Product/ReviewUpdat.html">Follow up width review</a></li>
						</ul>
					</li>
					<li class="dropdown">
                        <a href="javascript:;" class="dropdown-toggle">
                          <span class="micon bi bi-file-earmark-text"></span
                          ><span class="mtext">Voucher </span>
                        </a>
						<ul class="submenu">
							<li><a href="../VoucherRawaah/Voucher.html">ALL Voucher</a></li>
						  </ul>
                    </li>
					<li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
						  <span class="micon bi bi-file-earmark-text"></span
						  ><span class="mtext">Orders </span>
						</a>
						<ul class="submenu">
							<li><a href="../Order/AllOrder.html">ALL Order</a></li>
							<li><a href="../Order/GetOrder.html">Search By Email</a></li>
						</ul>
					</li>
				    <li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
						  <span class="micon bi bi-file-earmark-text"></span
						  ><span class="mtext">Contact </span>
						</a>
						<ul class="submenu">
						  <li><a href="../Contact/Contact Us.html">ALL Contact</a></li>
						
						</ul>
					  </li>
					  <li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
						  <span class="micon bi bi-file-earmark-text"></span
						  ><span class="mtext">RequestSell</span>
						</a>
						<ul class="submenu">
							<li><a href="../RequestSell/RequestSell.html">RequestSell</a></li>
						
						</ul>
					  </li>
                      <li class="dropdown">
						<a href="javascript:;" class="dropdown-toggle">
						  <span class="micon bi bi-file-earmark-text"></span
						  ><span class="mtext">Costumers</span>
						</a>
						<ul class="submenu">
							<li><a href="../Costumer/AllUser.html">AllUser</a></li>
					

						</ul>
					  </li>
				
				</ul>
			</div>
		</div>
	</div>
	<div class="mobile-menu-overlay"></div>
    
    <div class="container mt-5">
        <div class="text-center mb-4">
            <h2 class="text-primary">User Details</h2>
            <p class="text-muted">Complete overview of user information and activity.</p>
        </div>
    
        <div id="user-info" class="alert alert-danger" style="display: none;"></div>
    
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-user-circle me-2"></i>User Information</h5>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Username:</strong> <span id="username"></span></p>
                        <p><strong>Email:</strong> <span id="email"></span></p>
                        <p><strong>Phone:</strong> <span id="phone"></span></p>
                        <p><strong>Address:</strong> <span id="address"></span></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Gender:</strong> <span id="gender"></span></p>
                        <p><strong>Points:</strong> <span id="points"></span></p>
                    </div>
                </div>
            </div>
        </div>
    
        <ul class="nav nav-tabs mb-3" id="userDetailsTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="orders-tab" data-bs-toggle="tab" data-bs-target="#orders" type="button">Orders</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="sale-requests-tab" data-bs-toggle="tab" data-bs-target="#sale-requests" type="button">Sale Requests</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments" type="button">Comments</button>
            </li>
        </ul>
    
        <div class="tab-content" id="userDetailsTabContent">
            <div class="tab-pane fade show active" id="orders" role="tabpanel">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Status</th>
                            <th>Total Amount</th>
                            <th>Order Date</th>
                        </tr>
                    </thead>
                    <tbody id="orders-table-body"></tbody>
                </table>
            </div>
    
            <div class="tab-pane fade" id="sale-requests" role="tabpanel">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Product Name</th>
                            <th>Request Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="sale-requests-table-body"></tbody>
                </table>
            </div>
    
            <div class="tab-pane fade" id="comments" role="tabpanel">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Comment</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="comments-table-body"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetchUserData();
    
            function fetchUserData() {
                var userId = localStorage.getItem("userId");
                fetch(`https://localhost:44332/api/Users/UserDetails/${userId}`)
                    .then(response => response.json())
                    .then(data => {
                        // ملء المعلومات العامة
                        document.getElementById('username').innerText = data.userName;
                        document.getElementById('email').innerText = data.email;
                        document.getElementById('phone').innerText = data.phoneNumber;
                        document.getElementById('address').innerText = data.address;
                        document.getElementById('gender').innerText = data.gender;
                        document.getElementById('points').innerText = data.points;
    
                        // ملء جدول الطلبات
                        fillOrdersTable(data.orders);
                        // ملء جدول طلبات البيع
                        fillSaleRequestsTable(data.saleRequests);
                        // ملء جدول التعليقات
                        fillCommentsTable(data.comments);
                    })
                    .catch(error => {
                        console.error('Error fetching user data:', error);
                        document.getElementById('user-info').style.display = 'block';
                        document.getElementById('user-info').innerText = 'فشل في تحميل بيانات المستخدم.';
                    });
            }
    
            function fillOrdersTable(orders) {
                const tableBody = document.getElementById('orders-table-body');
                tableBody.innerHTML = '';
                orders.forEach((order, index) => {
                    const row = `<tr>
                        <td>${index + 1}</td>
                        <td>${order.status}</td>
                        <td>${order.amount}</td>
                        <td>${order.date}</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
            }
    
            function fillSaleRequestsTable(saleRequests) {
                const tableBody = document.getElementById('sale-requests-table-body');
                tableBody.innerHTML = '';
                saleRequests.forEach((request, index) => {
                    const row = `<tr>
                        <td>${index + 1}</td>
                        <td>${request.product.name}</td>
                        <td>${request.requestDate}</td>
                        <td>${request.status}</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
            }
    
            function fillCommentsTable(comments) {
                const tableBody = document.getElementById('comments-table-body');
                tableBody.innerHTML = '';
                comments.forEach((comment, index) => {
                    const row = `<tr>
                        <td>${index + 1}</td>
                        <td>${comment.comment1}</td>
                        <td>${comment.date}</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
            }
        });
    </script>
    
      

  <script>

    function logout() {
        localStorage.removeItem("jwtToken");
        localStorage.removeItem("UserId");
        window.location.href = "../../index_2.html";
        }
    </script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- js -->
  <script src="../vendors/scripts/core.js"></script>
  <script src="../vendors/scripts/script.min.js"></script>
  <script src="../vendors/scripts/process.js"></script>
  <script src="../vendors/scripts/layout-settings.js"></script>
  <script src="../src/plugins/apexcharts/apexcharts.min.js"></script>
  <script src="../src/plugins/datatables/js/jquery.dataTables.min.js"></script>
  <script src="../src/plugins/datatables/js/dataTables.bootstrap4.min.js"></script>
  <script src="../src/plugins/datatables/js/dataTables.responsive.min.js"></script>
  <script src="../src/plugins/datatables/js/responsive.bootstrap4.min.js"></script>
  <script src="../vendors/scripts/dashboard.js"></script>
  <script src="AllOrder.js"></script>
</body>
</html>
