<!-- @format -->

<!DOCTYPE html>
<html class="no-js" lang="en">
  <!-- Mirrored from htmldemo.net/dorno/dorno/my-account.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Sep 2024 19:54:29 GMT -->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Dorno - my account</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="DornoStyle/assets//img/favicon.ico"
    />

    <!-- CSS 
    ========================= -->
    <!--bootstrap min css-->
    <link rel="stylesheet" href="DornoStyle/assets/css/bootstrap.min.css" />
    <!--owl carousel min css-->
    <link rel="stylesheet" href="DornoStyle/assets/css/owl.carousel.min.css" />
    <!--slick min css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/slick.css" />
    <!--magnific popup min css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/magnific-popup.css" />
    <!--font awesome css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/font.awesome.css" />
    <!--ionicons min css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/ionicons.min.css" />
    <!--animate css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/animate.css" />
    <!--jquery ui min css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/jquery-ui.min.css" />
    <!--slinky menu css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/slinky.menu.css" />
    <!--plugins css-->
    <link rel="stylesheet" href="DornoStyle/assets//css/plugins.css" />

    <!-- Main Style CSS -->
    <link rel="stylesheet" href="DornoStyle/assets//css/style.css" />

    <!--modernizr min js here-->
    <script src="DornoStyle/assets//js/vendor/modernizr-3.7.1.min.js"></script>
  </head>

  <body>
    <!--header area start-->    

  <!--header area end-->

    <!--breadcrumbs area start-->
    <div class="breadcrumbs_area">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <div class="breadcrumb_content">
              <h3>My Account</h3>
              <ul>
                <li><a href="index.html">home</a></li>
                <li>My account</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--breadcrumbs area end-->

    <!-- my account start  -->
    <section class="main_content_area">
      <div class="container">
        <div class="account_dashboard">
          <div class="row">
            <div class="col-sm-12 col-md-3 col-lg-3">
              <!-- Nav tabs -->
              <div class="dashboard_tab_button">
                <ul role="tablist" class="nav flex-column dashboard-list">
                  <li>
                    <a href="#" data-bs-toggle="tab" class="nav-link active"
                      >Dashboard</a
                    >
                  </li>
                  <li>
                    <a href="#orders" data-bs-toggle="tab" class="nav-link "
                      >Orders</a
                    >
                  </li>
                
                 
                  <li>
                    <a
                      href="#account-details"
                      data-bs-toggle="tab"
                      class="nav-link"
                      >Account details</a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-sm-12 col-md-9 col-lg-9">
              <!-- Tab panes -->
              <div class="tab-content dashboard_content">
                <div class="tab-pane fade show active" id="dashboard">
                  <h3>Dashboard</h3>
                  <p>
                    From your account dashboard. you can easily check &amp; view
                    your <a href="#">recent orders</a>, manage your
                    <a href="#">shipping and billing addresses</a> and
                    <a href="#">Edit your password and account details.</a>
                  </p>
                </div>
                <div class="tab-pane fade" id="orders">
                  <h3>Orders</h3>
                  <div class="table-responsive">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>name</th>
                          <th>Total</th>
                          <th>email</th>
                          <th>Status</th>
                          <th>View</th>
                        </tr>
                      </thead>
                      <tbody id="container">
                      
                      </tbody>
                    </table>
                  </div>
                </div>
                </div>
                <div class="tab-pane fade" id="downloads">
                  <h3>Downloads</h3>
                  <div class="table-responsive">
                    <table class="table" >
                      <thead>
                        <tr>
                          <th>Product</th>
                          <th>Price</th>
                          <th>Brand</th>
                          <th>Quantity</th>
                          <th>Download</th>
                        </tr>
                      </thead>
                      <tbody id="downloadsTable">
                        
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <div class="tab-pane fade" id="account-details">
                  <h3>Account details</h3>
                  <div class="login">
                    <div class="login_form_container">
                      <div class="account_login_form">
                        <form id="editProfileForm">
                          <br />
                          <label>Full Name</label>
                          <input type="text" name="Name" id="name" />

                          <label>Email</label>
                          <input type="email" name="Email" id="email" />

                          <label>Password</label>
                          <input
                            type="password"
                            name="Password"
                            id="password"
                          />

                          <label>Confirm Password</label>
                          <input
                            type="password"
                            name="confirm-password"
                            id="confirm-password"
                          />

                          <label>Your Address</label>
                          <input type="text" name="Address" id="addrress" />

                          <label>Phone Number</label>
                          <input
                            type="text"
                            name="PhoneNumber"
                            id="phone-number"
                          />

                          <br />
                          <div class="save_button primary_btn default_button">
                            <button type="button" class="btn btn-danger" onclick="submitEditProfile()">
                              Save
                            </button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- my account end   -->

    <!--footer area start-->
 
    <!--footer area end-->

    <!-- JS
============================================ -->
    <!--jquery min js-->
    <script src="DornoStyle/assets//js/vendor/jquery-3.4.1.min.js"></script>
    <!--popper min js-->
    <script src="DornoStyle/assets//js/popper.js"></script>
    <!--bootstrap min js-->
    <script src="DornoStyle/assets//js/bootstrap.min.js"></script>
    <!--owl carousel min js-->
    <script src="DornoStyle/assets//js/owl.carousel.min.js"></script>
    <!--slick min js-->
    <script src="DornoStyle/assets//js/slick.min.js"></script>
    <!--magnific popup min js-->
    <script src="DornoStyle/assets//js/jquery.magnific-popup.min.js"></script>
    <!--counterup min js-->
    <script src="DornoStyle/assets//js/jquery.counterup.min.js"></script>
    <!--jquery countdown min js-->
    <script src="DornoStyle/assets//js/jquery.countdown.js"></script>
    <!--jquery ui min js-->
    <script src="DornoStyle/assets//js/jquery.ui.js"></script>
    <!--jquery elevatezoom min js-->
    <script src="DornoStyle/assets//js/jquery.elevatezoom.js"></script>
    <!--isotope packaged min js-->
    <script src="DornoStyle/assets//js/isotope.pkgd.min.js"></script>
    <!--slinky menu js-->
    <script src="DornoStyle/assets//js/slinky.menu.js"></script>
    <!-- Plugins JS -->
    <script src="DornoStyle/assets//js/plugins.js"></script>
    <script src="JavaScript/navebar.js"></script>

    <script src="JavaScript/editUser.js"></script>
    <script src="JavaScript/miniCart.js"></script>

    <!-- Main JS -->
    <script src="DornoStyle/assets//js/main.js"></script>

    <script>
      function downloadExcel() {
        
        // Select the table element
        var wb = XLSX.utils.table_to_book(document.querySelector(".table"), {
          sheet: "Sheet1",
        });
        // Generate a binary string
        var wbout = XLSX.write(wb, { bookType: "xlsx", type: "binary" });
  
        // Convert binary string to array buffer
        function s2ab(s) {
          var buf = new ArrayBuffer(s.length);
          var view = new Uint8Array(buf);
          for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff;
          return buf;
        }
  
        // Create a Blob object and trigger download
        var blob = new Blob([s2ab(wbout)], { type: "application/octet-stream" });
        var link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "table.xlsx";
        link.click();
      }
  
      //////////////////////////////////////////////////////////////////
  
      var userID = localStorage.getItem("UserId");
      console.log(userID);
      const url = `https://localhost:44332/api/Order/download-order/${userID}`;
  
      async function getdata() {
        debugger
        const requst = await fetch(url);
        const response = await requst.json();
        console.log(response);
        var continer = document.getElementById("container");
  
        response.forEach((element) => {
          continer.innerHTML += `
     <tr>
       
          <td>${element.username}</td>
          <td>${element.amount} </td>
          <td>${element.email} </td>
          <td>${statuse(element.status)} </td>
         <td><button class="download-btn" onclick="downloadOrder(${element.orderId})">
                    <i class="fa fa-download"></i> Download
                  </button></td>
      <tr>
  
          `;
        });
      }
      getdata();
      function statuse(status) {
          if (status === 0) {
            return "Pending";
          } else if (status === 1) {
            return "Delivered";
          } else {
            return "Cancelled";
          }
      }
      async function loadDownloadData(orderId) {
      try {
        debugger
        event.preventDefault();
        const response = await fetch(`https://localhost:44332/api/Order/download-orderItems/${orderId}`);
        if (!response.ok) {
          throw new Error("Failed to fetch download data");
        }
        const data = await response.json();
        console.log(data);

        // Inject data into the #downloadsTable
        const tableBody = document.getElementById("downloadsTable");
        tableBody.innerHTML = ""; // Clear previous content

        data.forEach(item => {
          tableBody.innerHTML += `
            <tr>
              <td>${item.user.username}</td>
              <td>${item.price}</td>
              <td>${item.productBrand}</td>
              <td>${item.quantity}</td>
              <td><a class="view">Download</a></td>
            </tr>`
          ;
        });

      } catch (error) {
        console.error("Error fetching download data: ", error);
      }
    }




    ///////////////////////////////////////////////////////////////////////////////////////

    async function downloadOrder(orderId) {
      debugger
        const url = `https://localhost:44362/api/Order/GenerateInvoice?orderId=${orderId}`;

        const link = document.createElement("a");
        link.href = url;
        link.download = `invoice_${orderId}.pdf`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
      ////////////////////////////////////////////////////////////////////

    // Function to smoothly scroll to the #downloads section
    function smoothScrollToDownloads() {
      const downloadsSection = document.querySelector("#downloads");
      if (downloadsSection) {
        downloadsSection.scrollIntoView({ behavior: "smooth" });
      } else {
        console.error("#downloads section not found");
      }
    }

    // Function to load data and scroll to the #downloads section
    async function loadDownloadDataAndScroll(orderId) {
      await loadDownloadData(orderId); // Wait for data to load
      smoothScrollToDownloads(); // Scroll smoothly to #downloads section
    }
    </script>
  
  </body>

  <!-- Mirrored from htmldemo.net/dorno/dorno/my-account.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Sep 2024 19:54:29 GMT -->
</html>
